<%- include('./includes/head.ejs') %>
</head>
<body class="h-100">
    <%- include('./includes/navigation.ejs') %>

    <!-- Body -->

    <h1 class="text-center">Quá trình làm việc</h1>
    <div class="container">
      <div class="card my-3">
        <div class="card-header">
          Lựa chọn các chức năng sau:
        </div>
        <div class="card-body">
          <a class="btn btn-primary mx-2 disabled">
            Phiên làm việc
          </a>
          <a class="btn btn-primary mx-2" href="/work-hour/annual-leaves">Ngày phép</a>
          <a class="btn btn-primary mx-2" href="/work-hour/salary">Chi tiết lương</a>
        </div>
      </div>
    
      <div class="card my-3">
        <div class="card-header">
          <h4 class="text-center">Phiên làm việc</h4>
        </div>
        <div class="card-body">
          <table class="table">
           
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Bắt đầu</th>
                <th scope="col">Kết thúc</th>
                <th scope="col">Thời gian</th>
                <th scope="col">Nơi làm việc</th>

              </tr>
            </thead>
            <tbody>
              <% workedHours.forEach(workedHour=>{%>
                <tr>
                  <th colspan="5" class="text-center"><%= workedHour.workDate%></th>
                </tr>
                <% workedHour.sessionWorks.forEach((sessionWork,index) =>{ %>
                    <tr>
                      <th scope="row"><%= index+1 %></th>
                      <td><%= new Date(sessionWork.startHour).getHours()%>:<%=new Date(sessionWork.startHour).getMinutes()%></td>
                      <td><% if(sessionWork.endHour){ %><%= new Date(sessionWork.endHour).getHours()%>:<%=new Date(sessionWork.endHour).getMinutes()%>%><% } else{  %>--<% } %></td>
                      <td><% if(sessionWork.endHour){%><%= new Date(new Date(sessionWork.endHour) - new Date(sessionWork.startHour) + (new Date().getTimezoneOffset()-60) * 60000).getHours()%>:<%= new Date(new Date(sessionWork.endHour) - new Date(sessionWork.startHour) ).getMinutes()%>:<%= new Date(new Date(sessionWork.endHour) - new Date(sessionWork.startHour) ).getSeconds()%><% }else{%>Chưa kết thúc<% } %></td>
                      <td><% if(sessionWork.workPlace === 1) {%>Cong ty<%}else if(sessionWork.workPlace === 2){%>Nha<%} else{%>Khach hang<%}%></td>
                    </tr>
                <% })%>
                <tr>
                  <th colspan="2" rowspan="3" class="text-center">Tổng cộng</th>
                  <th>Tổng giờ</th>
                  <td ><%= new Date(workedHour.workHours1 + ((new Date().getTimezoneOffset() -60)* 60000)).getHours()%>:<%= new Date(workedHour.workHours1 + (new Date().getTimezoneOffset() * 60000)).getMinutes()%>:<%= new Date(workedHour.workHours1 + (new Date().getTimezoneOffset() * 60000)).getSeconds()%></td>

                </tr>
                <tr>
                  <th>Tổng thêm giờ</th>
                  <td ><%= new Date(workedHour.overTime + ((new Date().getTimezoneOffset() -60)* 60000)).getHours()%>:<%= new Date(workedHour.overTime + (new Date().getTimezoneOffset() * 60000)).getMinutes()%>:<%= new Date(workedHour.overTime + (new Date().getTimezoneOffset() * 60000)).getSeconds()%></td>

                </tr>
                <tr>
                  <th>Nghỉ phép</th>
                  <td ><% if(workedHour.leave){%><%= workedHour.leave %><%}else{%><%=0.0%><%}%></td>

                </tr>
              <% })%>
              
            </tbody>
          </table>
        </div>
      
      

   

    <%- include('./includes/end.ejs') %>
