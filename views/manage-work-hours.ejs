<%- include('./includes/head.ejs') %>
</head>
<body class="h-100">
    <%- include('./includes/navigation.ejs') %>

    <!-- Body -->

    <h1 class="text-center">Quá trình làm việc</h1>
    <div class="container">
      <div class="card my-3">
        <div class="card-header">
          Lựa chọn các chức năng sau:
        </div>

        <div class="card-body">
         
          <form action="/manage/staff/<%=staffId%>" method="POST">
            <div class="row">
              <div class="col-md-4 input-group mb-3">
                <div class="input-group-prepend">
                  <label class="input-group-text" for="inputGroupSelect01">Năm</label>
                </div>
                <select class="custom-select" id="inputGroupSelect01" name="yearWork">
                  <option selected>Chọn năm...</option>
                  <option value="2022">2022</option>
                  <option value="2021">2021</option>
                  <option value="2020">2020</option>
                  <option value="2019">2019</option>
                  <option value="2018">2018</option>
                  <option value="2017">2017</option>
                  <option value="2016">2016</option>

                </select>
              </div>
              <div class="col-md-4 input-group mb-3">
                <div class="input-group-prepend">
                  <label class="input-group-text" for="inputGroupSelect02">Tháng</label>
                </div>
                <select class="custom-select" id="inputGroupSelect02" name="monthWork">
                  <option selected>Chọn tháng...</option>
                  <option value="01">Tháng 1</option>
                  <option value="02">Tháng 2</option>
                  <option value="03">Tháng 3</option>
                  <option value="04">Tháng 4</option>
                  <option value="05">Tháng 5</option>
                  <option value="06">Tháng 6</option>
                  <option value="07">Tháng 7</option>
                  <option value="08">Tháng 8</option>
                  <option value="09">Tháng 9</option>
                  <option value="10">Tháng 10</option>
                  <option value="11">Tháng 11</option>
                  <option value="12">Tháng 12</option>

                </select>
              </div>
            </div>
            
            <button type="submit" class="btn btn-primary">Hiển thị</button>
          </form>
          
        </div>
          
      </div>
    
      <div class="card my-3">
        <div class="card-header">
          <h4 class="text-center">Phiên làm việc</h4>
          
        </div>
       
        <div class="card-body">
          
          <% if(isPost){%>
            
          <!-- ----------------------------------->
          <table class="table">
           
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Bắt đầu</th>
                <th scope="col">Kết thúc</th>
                <th scope="col">Thời gian</th>
                <th scope="col">Nơi làm việc</th>
                <th scope="col">Hành động</th>

              </tr>
            </thead>
            <tbody>
              <% workedHours.forEach(workedHour=>{%>
                <tr>
                  <th colspan="5" class="text-center"><%= workedHour.workDate%></th>
                </tr>
                <% workedHour.sessionWorks.forEach((sessionWork,index) =>{ %>
                    <tr>
                      <th scope="row"><%= index+1 %></th>
                      <td><%= sessionWork.startHour%></td>
                      <td><%= sessionWork.endHour %></td>
                      <td><%= sessionWork.hourdiff %></td>
                      <td><%= sessionWork.workPlace%></td>
                      <% if(sessionWork.endHour !== "--") {%>
                      <td><a class="btn btn-primary <%= workedHour.isLock? 'disabled':''%>" href="/manage/edit/staff/<%= sessionWork._id %>">Xoá</a></td>
                      <%}%>
                    </tr>
                <% })%>
                <tr>
                  <th colspan="2" rowspan="3" class="text-center">Tổng cộng</th>
                  <th>Tổng giờ</th>
                  <td ><%= workedHour.workHours1%></td>

                </tr>
                <tr>
                  <th>Tổng thêm giờ</th>
                  <td ><%= workedHour.overTime%></td>

                </tr>
                <tr>
                  <th>Nghỉ phép</th>
                  <td ><% if(workedHour.leave){%><%= workedHour.leave %><%}else{%><%=0.0%><%}%></td>

                </tr>
              <% })%>
              
            </tbody>
          </table>
          <% if(!isLock){%>
            <form class="text-center" action="/manage/confirm/staff/<%=staffId%>" method="POST">
              <input type="hidden" name="monthWork" value="<%= month%>"/>
              <input type="hidden" name="yearWork" value="<%= year%>"/>
              
              <button type="submit" class="btn btn-primary">Xác nhận thời gian làm việc</button>
              
            </form>
            <% }%>

          <% }else{%>
          <p>Chưa có dữ liệu</p>
          <% }%>
        </div>
      
      

   

    <%- include('./includes/end.ejs') %>
